Translated to C++ from:

https://gist.github.com/tlehman/1542346
